<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2FA Generator - Geigi.net</title>
  <link rel="icon" href="icon3 (1).png">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background-color: #0a0a0a;
      color: #eaf3ff;
      font-family: 'Inter', sans-serif;
    }
    .glow {
      position: fixed;
      width: 250px;
      height: 250px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(59,123,255,0.2) 0%, rgba(59,123,255,0) 70%);
      pointer-events: none;
      z-index: -1;
      animation: float 10s ease-in-out infinite;
    }
    .glow-2 { animation-delay: 2s; }
    @keyframes float {
      0%,100% { transform: translate(0,0);}
      25% { transform: translate(30px,20px);}
      50% { transform: translate(0,40px);}
      75% { transform: translate(-30px,20px);}
    }
    .social-card {
      background: #162a4d;
      color: #eaf3ff;
      border-radius: 8px;
      padding: 0.5em 1em;
      display: flex;
      align-items: center;
      gap: 0.7em;
      font-size: 1rem;
      box-shadow: 0 2px 8px #0003;
      transition: background 0.18s, color 0.18s;
      text-decoration: none;
    }
    .social-card:hover {
      background: #3b7bff;
      color: #fff;
    }

    /* Einheitliches Burger-Menü */
    .mobile-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background-color: #162a4d;
      border: 1px solid #3b7bff;
      border-radius: 8px;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      min-width: 170px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transform: translateY(-10px);
      pointer-events: none;
      transition: all 0.25s ease;
    }
    .mobile-menu.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }
    .nav-btn {
      background: none;
      border: none;
      color: #eaf3ff;
      font-size: 1.8rem;
      cursor: pointer;
      padding: 0.5rem;
    }
  </style>
  <!-- jsSHA for SHA-1 HMAC -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsSHA/2.4.2/sha.js"></script>
</head>
<body class="bg-[#0a0a0a]">

<div class="glow top-20 left-16"></div>
<div class="glow glow-2 bottom-20 right-16"></div>

<!-- Navbar -->
<header class="fixed top-0 left-0 right-0 bg-black/80 backdrop-blur-md border-b border-blue-600 z-50">
  <div class="max-w-7xl mx-auto flex justify-between items-center p-4">
    <a href="/" class="text-blue-500 font-bold text-xl">Geigi.net</a>
    <div class="relative">
      <button class="nav-btn" onclick="toggleMobileMenu()">☰</button>
      <div class="mobile-menu" id="mobileMenu">
        <a href="/" class="hover:text-blue-400 transition">Home</a>
        <a href="projects" class="hover:text-blue-400 transition">Projects</a>
        <a href="buying" class="hover:text-blue-400 transition">Buying Accounts</a>
        <a href="2fa" class="text-blue-500 font-semibold">2FA Generator</a>
        <a href="verify" class="hover:text-blue-400 transition">Verification</a>
        <a href="https://dcserver.dev/" target="_blank" class="hover:text-blue-400 transition">Discord Setups</a>
        <div class="sidebar-social flex-row flex gap-3 mt-3">
          <a class="social-card" href="https://discord.com/users/463953200559685632" target="_blank" rel="noopener noreferrer">
            <img src="discord.png" alt="Discord" style="width:24px;height:24px;object-fit:contain;">
            @geigi
          </a>
          <a class="social-card" href="https://oguser.com/geigi" target="_blank" rel="noopener noreferrer">
            <img src="Oguserslogo.png" alt="OGU" style="width:24px;height:24px;object-fit:contain;">
            /geigi
          </a>
        </div>
      </div>
    </div>
  </div>
</header>

<main class="max-w-xl mx-auto px-6 pt-32 pb-16">
  <section class="flex flex-col items-center bg-[#162a4d]/60 backdrop-blur-lg rounded-3xl shadow-2xl border border-blue-600 p-8 w-full">
    <h1 class="text-3xl md:text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-500 to-blue-300 mb-4">2FA Code Generator</h1>
    <div class="text-blue-200 text-base mb-6 text-center max-w-md">
      <b>Generate your 2FA codes easily.</b><br>
      Paste your 2FA Secret below!
    </div>
    <input type="text" id="secret" class="w-full px-4 py-3 rounded-lg bg-[#23262f] text-white text-lg mb-4 text-center outline-none border border-blue-700 focus:border-blue-400 transition" placeholder="Enter your TOTP secret here...">
    <div id="codeSection" class="w-full flex flex-col items-center mb-4">
      <input id="otp" class="code-box bg-[#23262f] text-white text-3xl font-mono rounded-lg px-6 py-3 mb-2 text-center outline-none border border-blue-700 focus:border-blue-400 transition select-all inactive cursor-pointer" value="000000" readonly title="Click to copy">
      <div class="timer text-blue-200 text-base" id="timer">Expires in 30s</div>
    </div>
    <div class="error text-red-400 text-center text-base min-h-[1.2em]" id="error"></div>
    <div class="text-blue-300 text-xs text-center mt-6">
      <b>Note:</b> Your secret never leaves your browser.<br>
      Codes refresh every 30 seconds. Click the code to copy!
    </div>
  </section>
</main>

<script>
  // Mobile menu toggle
  function toggleMobileMenu() {
    const menu = document.getElementById('mobileMenu');
    menu.classList.toggle('show');
  }

  // 2FA JS
  const secret = document.getElementById('secret');
  var secretKey = "";
  var currentOtp = 0;

  function leftpad(str, len, pad) {
    if (len + 1 >= str.length) {
      str = Array(len + 1 - str.length).join(pad) + str;
    }
    return str;
  }

  function dec2hex(s) { return (s < 15.5 ? '0' : '') + Math.round(s).toString(16); }
  function hex2dec(s) { return parseInt(s, 16); }

  function base32tohex(base32) {
    var base32chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";
    var bits = "";
    var hex = "";

    for (var i = 0; i < base32.length; i++) {
      var val = base32chars.indexOf(base32.charAt(i).toUpperCase());
      bits += leftpad(val.toString(2), 5, '0');
    }

    for (var i = 0; i + 4 <= bits.length; i += 4) {
      var chunk = bits.substr(i, 4);
      hex = hex + parseInt(chunk, 2).toString(16);
    }
    return hex;
  }

  function updateOtp() {
    const otpInput = document.getElementById('otp');
    if (secretKey.length >= 16 && secretKey.length <= 40) {
      try {
        var key = base32tohex(secretKey);
        var epoch = Math.round(new Date().getTime() / 1000);
        var time = leftpad(dec2hex(Math.floor(epoch / 30)), 16, '0');

        var shaObj = new jsSHA("SHA-1", "HEX");
        shaObj.setHMACKey(key, "HEX");
        shaObj.update(time);
        var hmac = shaObj.getHMAC("HEX");
        var offset = hex2dec(hmac.substring(hmac.length - 1));

        var otp = (hex2dec(hmac.substr(offset * 2, 8)) & hex2dec('7fffffff')) + '';
        otp = otp.substring(otp.length - 6);

        currentOtp = otp;
        otpInput.value = otp;
        otpInput.classList.remove('inactive');
        document.getElementById('error').textContent = "";
      } catch {
        currentOtp = 0;
        otpInput.value = "000000";
        otpInput.classList.add('inactive');
        document.getElementById('error').textContent = "Invalid secret!";
      }
    } else {
      currentOtp = 0;
      otpInput.value = "000000";
      otpInput.classList.add('inactive');
      document.getElementById('error').textContent = "";
    }
  }

  function timer() {
    const otpInput = document.getElementById('otp');
    if (currentOtp != 0) {
      var epoch = Math.round(new Date().getTime() / 1000);
      var countDown = 30 - (epoch % 30);
      if (epoch % 30 == 0) updateOtp();
      document.getElementById('timer').innerHTML = "Expires in " + countDown + "s";
    } else {
      document.getElementById('timer').innerHTML = "Expires in 30s";
    }
  }

  secret.addEventListener('input', function () {
    secretKey = secret.value.replace(/ /g, '');
    updateOtp();
    if (secretKey.length == 0) {
      document.getElementById('timer').innerHTML = "Expires in 30s";
      currentOtp = 0;
      document.getElementById('otp').value = "000000";
      document.getElementById('otp').classList.add('inactive');
      document.getElementById('error').textContent = "";
    }
  });

  function fallbackCopyTextToClipboard(text) {
    var textArea = document.createElement("textarea");
    textArea.value = text;

    textArea.style.top = "0";
    textArea.style.left = "0";
    textArea.style.position = "fixed";

    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();

    try {
      document.execCommand('copy');
    } catch (err) {
      // ignore
    }

    document.body.removeChild(textArea);
  }

  function copyTextToClipboard(text) {
    if (!navigator.clipboard) {
      fallbackCopyTextToClipboard(text);
      return;
    }
    navigator.clipboard.writeText(text);
  }

  document.getElementById('otp').addEventListener('click', () => {
    const otpInput = document.getElementById('otp');
    const prev = otpInput.value;
    copyTextToClipboard(currentOtp == 0 ? "000000" : currentOtp);
    otpInput.value = "Copied!";
    setTimeout(() => {
      otpInput.value = prev;
    }, 1100);
  });

  setInterval(timer, 1000);
</script>
</body>
</html>



